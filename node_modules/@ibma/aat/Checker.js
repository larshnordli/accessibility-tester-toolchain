/******************************************************************************
 * Licensed Materials - Property of IBM
 * "Restricted Materials of IBM"
 * Â© Copyright IBM Corp. 2016 All Rights Reserved.
 *
 * Copying, redistribution and/or modification is prohibited.
 * U.S. Government Users Restricted Rights - Use, duplication or
 * disclosure restricted by GSA ADP Schedule Contract with IBM Corp.
 *****************************************************************************/
var IBMa={};!function(){"undefined"==typeof String.prototype.startswith&&(String.prototype.startswith=function(e){return this.substring(0,e.length)==e}),"undefined"==typeof String.prototype.trim&&(String.prototype.trim=function(){return this.replace(/^[\s\n]+|[\s\n]+$/g,"")}),IBMa.Error=IBMa.Error||{log:function(){if(console)try{console.log.apply(null,arguments)}catch(e){console.log(arguments)}}},IBMa.Dom={},IBMa.Dom.NodeWalker=function(e,t,n){this.root=n||e,this.node=e,this.bEndTag=void 0!=t&&1==t},IBMa.Dom.NodeWalker.prototype.atRoot=function(){return this.root.isSameNode?this.root.isSameNode(this.node):0===this.root.compareDocumentPosition(this.node)},IBMa.Dom.NodeWalker.prototype.nextNode=function(){if((this.bEndTag||!this.node.firstChild)&&this.atRoot())return!1;if(!this.bEndTag&&this.node.firstChild)this.node=this.node.firstChild;else if(this.node.nextSibling)this.node=this.node.nextSibling,this.bEndTag=!1;else{if(!this.node.parentNode)return!1;this.node=this.node.parentNode,this.bEndTag=!0}return!0},IBMa.Dom.NodeWalker.prototype.prevNode=function(){if(!this.bEndTag&&this.atRoot())return!1;if(this.bEndTag&&this.node.lastChild)this.node=this.node.lastChild,this.bEndTag=!0;else if(this.node.previousSibling)this.node=this.node.previousSibling,this.bEndTag=!0;else{if(!this.node.parentNode)return!1;this.node=this.node.parentNode,this.bEndTag=!1}return!this.bEndTag||null!=this.node.firstChild&&"undefined"!=typeof this.node.firstChild||(this.bEndTag=!1),!0},IBMa.Context=function(e){this.attrCache=[],this.contextStr=e.trim().toLowerCase();var t=this.contextStr.indexOf("[");this.elementStr=t==-1?this.contextStr:this.contextStr.substring(0,t);var n=t==-1?null:this.contextStr.substring(t);if(null!=n)for(var o=n.split("]"),r=0;r<o.length;++r){var a={neq:!1},i=o[r].indexOf("=="),l=o[r].indexOf("!=");i==-1&&l==-1?(a.key=o[r].substring(2).trim(),a.value=null):i!=-1?(a.key=o[r].substring(2,i).trim(),a.value=o[r].substring(i+1).trim()):(a.key=o[r].substring(2,l).trim(),a.value=o[r].substring(l+1).trim(),a.neq=!0),null!=a.value&&(a.value=a.value.substring(2,a.value.length-1)),a.key.length>0&&this.attrCache.push(a)}},IBMa.Context.prototype.getElement=function(){return this.elementStr},IBMa.Context.prototype.attrsMatch=function(e){for(var t=!0,n=0;t&&n<this.attrCache.length;++n){var o=this.attrCache[n];t=(o.neq||e.hasAttribute(o.key))&&(null==o.value||o.neq!=(e.getAttribute(o.key)==o.value))}return t},IBMa.ARIA=IBMa.ARIA||{inputToRoleMap:function(){var e=function(e){return IBMa.ARIA.hasParentRole(e,"menu")?"menuitem":"button"},t=function(e){if(e.hasAttribute("list")){var t=e.getAttribute("list"),n=e.ownerDocument.getElementById(t);if(n&&"datalist"===n.nodeName.toLowerCase())return"combobox"}return"textbox"};return{button:e,image:e,checkbox:function(e){return IBMa.ARIA.hasParentRole(e,"menu")?"menuitemcheckbox":"checkbox"},radio:function(e){return IBMa.ARIA.hasParentRole(e,"menu")?"menuitemradio":"radio"},email:t,search:t,tel:t,text:t,url:t,password:"textbox",number:"spinbutton",range:"slider",reset:"button",submit:"button"}}(),inputToRole:function(e){if(!e)return null;var t="text";if(e.hasAttribute("type")&&e.getAttribute("type").toLowerCase().trim().length>0&&(t=e.getAttribute("type").toLowerCase().trim()),!(t in IBMa.ARIA.inputToRoleMap))return null;var n=IBMa.ARIA.inputToRoleMap[t];return"string"==typeof n?n:"function"==typeof n?n(e):null},hasParentRole:function(e,t){for(var n=e.parentNode;n;){if(IBMa.ARIA.elemToRole(n)===t)return!0;n=n.parentNode}return!1},elemToRoleMap:function(){var e={blockquote:!0,body:!0,details:!0,dialog:!0,fieldset:!0,figure:!0,td:!0},t={article:!0,aside:!0,nav:!0,section:!0},n=function(e){return IBMa.ARIA.inputToRole(e)};return{a:function(e){return e.hasAttribute("href")?IBMa.ARIA.hasParentRole(e,"menu")?"menuitem":"link":null},area:function(e){return e.hasAttribute("href")?"link":null},article:"article",aside:"complementary",body:"document",button:"button",datalist:"listbox",dd:"definition",dialog:"dialog",footer:function(n){for(var o=n.parentNode,r=o.nodeName.toLowerCase();o;){if(e[r]||t[r])return"body"===r?"contentinfo":null;o=o.parentNode,r=o.nodeName.toLowerCase()}return null},form:"form",h1:"heading",h2:"heading",h3:"heading",h4:"heading",h5:"heading",h6:"heading",header:function(n){for(var o=n.parentNode,r=o.nodeName.toLowerCase();o;){if(e[r]||t[r])return"body"===r?"banner":null;o=o.parentNode,r=o.nodeName.toLowerCase()}return null},hr:"separator",img:function(e){return e.hasAttribute("alt")&&0===e.getAttribute("alt").length?"presentation":"img"},input:n,keygen:"listbox",li:"listitem",main:"main",math:"math",menu:function(e){if(!e.hasAttribute("type"))return null;var t=e.getAttribute("type").toLowerCase();return"context"===t?"menu":"toolbar"===t?"toolbar":null},menuitem:function(e){if(!e.hasAttribute("type"))return"menuitem";var t=e.getAttribute("type").toLowerCase();return 0==t.trim().length?"menuitem":"command"===t?"menuitem":"checkbox"===t?"menuitemcheckbox":"radio"===t?"menuitemradio":null},nav:"navigation",ol:"list",optgroup:"group",option:"option",output:"status",progress:"progressbar",section:"region",select:function(e){return e.hasAttribute("multiple")||e.hasAttribute("size")&&parseInt(e.getAttribute("size"))>1?"listbox":"combobox"},table:"table",textarea:"textbox",tbody:"rowgroup",td:function(e){for(var t=e.parentNode;t;){var n=IBMa.ARIA.elemToRole(t);if("table"===n)return"cell";if("grid"===n)return"gridcell";t=t.parentNode}return null},th:function(e){if(e.hasAttribute("scope")){var t=e.getAttribute("scope").toLowerCase();if("row"===t)return"rowheader";if("col"===t)return"columnheader"}!e.hasAttribute("scope")||"auto"===e.getAttribute("scope").toLowerCase();for(var n=e.parentNode;n;){var o=IBMa.ARIA.elemToRole(n);if("table"===o)return"cell";if("grid"===o)return"gridcell";n=n.parentNode}return null},tfoot:"rowgroup",thead:"rowgroup",tr:"row",ul:"list"}}(),elemToRole:function(e){if(!e||1!=e.nodeType)return null;if(e.hasAttribute("role")&&e.getAttribute("role").trim().length>0)return e.getAttribute("role").trim();var t=e.nodeName.toLowerCase();if(!(t in IBMa.ARIA.elemToRoleMap))return null;var n=IBMa.ARIA.elemToRoleMap[t];return"string"==typeof n?n:"function"==typeof n?n(e):null}},IBMa.Config=IBMa.Config||{DEBUG:!1,ITER_COUNT:100,includeNodes:!0,includeBounds:!0,includePassed:!1,includeVisibility:!1,resultsVersion:1,rules:{},rulesRole:{},rulesById:{},metadata:{},metadataId:{},rs:{},rsMap:{},nls:{},locale:"en-us",loaded:!1,setTimeout:function(e,t){window.setTimeout(e,t)},clearRules:function(){IBMa.Config.rules={},IBMa.Config.rulesRole={},IBMa.Config.rulesById={},IBMa.Config.metadata={},IBMa.Config.metadataId={},IBMa.Config.rs={},IBMa.Config.rsMap={},IBMa.Config.nls={},IBMa.Config.loaded=!1},addRule:function(ruleObj){if(ruleObj.id in IBMa.Config.rulesById)return void console.log("addRule::Rule "+ruleObj.id+" already exists - skipping");"undefined"==typeof ruleObj.enabled&&(ruleObj.enabled=!0),ruleObj.ctxs=IBMa.Config.getContexts(ruleObj),ruleObj.ctxsRole=IBMa.Config.getContextsRole(ruleObj),ruleObj.oldValidate=ruleObj.validate,"function"!=typeof ruleObj.oldValidate&&(ruleObj.oldValidate=eval("("+ruleObj.oldValidate+")")),ruleObj.validate=function(e){var t=ruleObj.oldValidate(e);return typeof t==typeof!0?{result:t,msgArgs:[]}:t};for(var elem in ruleObj.ctxs)elem in IBMa.Config.rules||(IBMa.Config.rules[elem]=[]),IBMa.Config.rules[elem].push(ruleObj);for(var role in ruleObj.ctxsRole)role in IBMa.Config.rulesRole||(IBMa.Config.rulesRole[role]=[]),IBMa.Config.rulesRole[role].push(ruleObj);IBMa.Config.rulesById[ruleObj.id]=ruleObj},addRules:function(e){for(var t=0;t<e.length;++t)IBMa.Config.addRule(e[t])},getMatchingRules:function(e){return IBMa.Config.getMatchingRulesHidden(e,!1)},getMatchingRulesHidden:function(e,t){var n=[],o=null!==RPT.util.rulesThatHaveToCheckHidden&&void 0!==RPT.util.rulesThatHaveToCheckHidden;if(1==e.nodeType){var r=e.nodeName.toLowerCase();if(r in IBMa.Config.rules)for(var a=IBMa.Config.rules[r],i=0;i<a.length;++i)if(!t||!o||RPT.util.rulesThatHaveToCheckHidden.indexOf(a[i].id)!==-1)for(var l=0;l<a[i].ctxs[r].length;++l)if(a[i].ctxs[r][l].attrsMatch(e)){n.push(a[i]);break}if(r="*",r in IBMa.Config.rules)for(var a=IBMa.Config.rules[r],i=0;i<a.length;++i)if(!t||!o||RPT.util.rulesThatHaveToCheckHidden.indexOf(a[i].id)!==-1)for(var l=0;l<a[i].ctxs[r].length;++l)if(a[i].ctxs[r][l].attrsMatch(e)){n.push(a[i]);break}var u=IBMa.ARIA.elemToRole(e);if(u in IBMa.Config.rulesRole)for(var s=IBMa.Config.rulesRole[u],i=0;i<s.length;++i)n.push(s[i])}return n},getContexts:function(e){var t;if("undefined"==typeof e.context)return{};var n=e.context;t=n.indexOf("|")==-1?[n]:n.split("|");for(var o={},r=0;r<t.length;++r){var a=new IBMa.Context(t[r]),i=a.getElement();i in o||(o[i]=[]),o[i].push(a)}return o},getContextsRole:function(e){var t;if("undefined"==typeof e.contextRole)return{};var n=e.contextRole;t=n.indexOf("|")==-1?[n]:n.split("|");for(var o={},r=0;r<t.length;++r){var a=t[r];a in o||(o[a]=[])}return o},addMetadata:function(e){for(var t=0;t<e.length;++t)e[t].ruleId in IBMa.Config.metadata||(IBMa.Config.metadata[e[t].ruleId]=[]),IBMa.Config.metadata[e[t].ruleId].push(e[t]),IBMa.Config.metadataId[e[t].id]=e[t]},getMetadataForRule:function(e){return IBMa.Config.metadata[e]},addRuleset:function(e){IBMa.Config.rs[e.id]=e;for(var t=e,n=0;n<t.requirements.length;++n){var o=t.requirements[n];for(var r in o.rules)IBMa.Config.rsMap[r]=IBMa.Config.rsMap[r]||[],IBMa.Config.rsMap[r].push({rs:{id:e.id,label:IBMa.Config.getNLS(t.nameCode)},requirement:{id:o.criterionNumber,label:IBMa.Config.getNLS(o.criterionDesc),level:IBMa.Config.getNLS(o.criterionLevel)},levelCode:o.rules[r].severityCode})}},getAllRulesets:function(){return IBMa.Config.rs},getRulesetById:function(e){return IBMa.Config.rs[e]},addNLS:function(e,t){e=e.toLowerCase(),IBMa.Config.nls[e]=IBMa.Config.nls[e]||{};for(var n in t)IBMa.Config.nls[e][n]=t[n]},setLocale:function(e){e=e.toLowerCase()},getPageLocale:function(e){var t=e.documentElement;return t.hasAttribute("lang")?t.getAttribute("lang").toLowerCase():t.hasAttribute("xml:lang")?t.getAttribute("xml:lang").toLowerCase():null},getNLS:function(e,t,n){if(!e)return null;if(IBMa.Config.locale in IBMa.Config.nls&&e in IBMa.Config.nls[IBMa.Config.locale]){if(void 0==t||"undefined"==typeof t)return IBMa.Config.nls[IBMa.Config.locale][e];var o=IBMa.Config.nls[IBMa.Config.locale][e],r=o;if(r=r.replace(/</g,"&lt;"),r=r.replace(/>/g,"&gt;"),t.length>0&&(void 0==n||"undefined"==typeof n||1!=n)){var a=/{([0-9]+)}/g;r=r.replace(a,function(e,n){return t[n]})}return r}return e},getNLSMap:function(){return IBMa.Config.locale in IBMa.Config.nls?IBMa.Config.nls[IBMa.Config.locale]:null},populateMessage:function(e,t){for(var n={},o=e.ruleId,r=IBMa.Config.metadata[o],a=0;a<r.length;++a)n[r[a].rptMessageCode]||(n[r[a].rptMessageCode]=IBMa.Config.getNLS(r[a].rptMessageCode,e.msgArgs,!0));return n},populateMessages:function(e,t){for(var n={},o=0;o<e.length;++o){var r=IBMa.Config.populateMessage(e[o],t);for(var a in r)n[a]||(n[a]=r[a])}return n},populateResult:function(e,t){for(var n={"level.violation":0,"level.potentialviolation":1,"level.recommendation":2,"level.manual":3},o=[],r=e.ruleId,a=IBMa.Config.metadata[r],i=0;i<a.length;++i){var l={severityCode:IBMa.Config.sevMap[a[i].rptSeverityCode],messageCode:a[i].rptMessageCode,ruleId:a[i].id,help:"idhi_accessibility_check_g"+a[i].id+".html"};1===IBMa.Config.resultsVersion&&(l.severity=IBMa.Config.sevMap2[a[i].rptSeverityCode],l.message=IBMa.Config.getNLS(a[i].rptMessageCode,e.msgArgs));for(var u in e)u in l||(l[u]=e[u]);var s=null;1===IBMa.Config.resultsVersion&&(l.rsInfo=[]);var d=IBMa.Config.rsMap[l.ruleId];if(d){for(var f=0;f<d.length;++f)(!t||d[f].rs.id in t)&&(1===IBMa.Config.resultsVersion&&l.rsInfo.push(d[f]),null==s?s=d[f].levelCode:n[d[f].levelCode].idx<n[s]&&(s=d[f].levelCode));l.level=s,o.push(l)}}return o},populateResults:function(e,t){for(var n=[],o=0;o<e.length;++o)n=n.concat(IBMa.Config.populateResult(e[o],t));return n}},IBMa.Config.sevMap={"rpt.severity.high":"eISHigh","rpt.severity.medium":"eISMedium","rpt.severity.low":"eISLow","rpt.severity.information":"eISInformation"},IBMa.Config.sevMap2={"rpt.severity.high":"High","rpt.severity.medium":"Medium","rpt.severity.low":"Low","rpt.severity.information":"Information"},IBMa.Scan=IBMa.Scan||{reportDocument:function(e,t,n,o){IBMa.Scan.report(e,t,n,o)},report:function(e,t,n,o){IBMa.Config.DEBUG&&console.log("reportDocument");try{if(IBMa.Config.loaded){var r=null;if(t){r={};for(var a=0;a<t.length;++a)t[a]in IBMa.Config.rs?r[t[a]]=!0:t.splice(a--,1)}IBMa.Scan.setRulesets(t),IBMa.Scan.scan(e,function(o){if(o.counts={"level.violation":0,"level.potentialviolation":0,"level.recommendation":0,"level.potentialrecommendation":0,"level.manual":0},o.report){o.report.pass&&(o.report.pass=IBMa.Config.populateResults(o.report.pass,r));var a;1===IBMa.Config.resultsVersion?a=o.report.fail:(a=o.report.issues,a&&(o.issueMessages={},o.issueMessages.messages=IBMa.Config.populateMessages(a,r),o.issueMessages.lang="en-us")),a&&(a=IBMa.Config.populateResults(a,r),a.forEach(function(e){e.level in o.counts||(o.counts[e.level]=0),o.counts[e.level]=o.counts[e.level]+1,1!==IBMa.Config.resultsVersion&&null!=e.level&&"undefined"!=typeof e.level&&(e.level=e.level.replace("level.",""))})),1===IBMa.Config.resultsVersion?o.report.fail=a:o.report.issues=a}1!==IBMa.Config.resultsVersion&&e.title&&(o.report.docTitle=e.title),n(o,t)},o)}else setTimeout(function(){IBMa.Scan.report(e,t,n,o)},1e3)}catch(i){n({exception:""+i},t)}},setRulesets:function(e){IBMa.Config.DEBUG&&console.log("setRulesets");var t=0;for(var n in IBMa.Config.rulesById)++t,IBMa.Config.rulesById[n].enabled=!e,n in IBMa.Config.metadata||(IBMa.Config.rulesById[n].enabled=!1);if(IBMa.Config.DEBUG&&console.log((e?"Disabled ":"Enabled ")+t+" rules"),e){"string"==typeof e&&(e=e.split(",")),t=0;for(var o=0;o<e.length;++o){var r=IBMa.Config.getRulesetById(e[o]);if(r)for(var a=0;a<r.requirements.length;++a)for(var i in r.requirements[a].rules)if(i in IBMa.Config.metadataId){var n=IBMa.Config.metadataId[i].ruleId;n in IBMa.Config.rulesById?(IBMa.Config.rulesById[n].enabled||++t,IBMa.Config.rulesById[n].enabled=!0):IBMa.Error.log("Inconsistency in metadata for rule:",n)}else IBMa.Error.log("ERROR: Meta ID "+i+" not found from ruleset "+e[o])}IBMa.Config.DEBUG&&console.log("Enabled "+t+" rules")}},scanDocument:function(e,t,n){IBMa.Scan.scan(e,t,n)},scan:function(e,t,n){IBMa.Config.DEBUG&&console.log("scan");try{var o,r;9===e.nodeType?(o=e,r=e.documentElement):(o=e.ownerDocument,r=e),IBMa.Config.ruleDocument.validationGlobals={},IBMa.Scan.stripFirebug(o);var a=IBMa.Config.includeVisibility;null==a||"undefined"==a||void 0==a?o.PT_CHECK_HIDDEN_CONTENT=!1:o.PT_CHECK_HIDDEN_CONTENT=a;var i=new IBMa.Dom.NodeWalker(r);if(o.documentElement.EXT_SCANNED){var l=new IBMa.Dom.NodeWalker(o.documentElement);IBMa.Config.setTimeout(function(){IBMa.Scan.cleanIter(l,i,t,n)},0)}else o.documentElement.EXT_SCANNED=!0,IBMa.Config.setTimeout(function(){IBMa.Scan.checkIter(i,t,n,null)},0)}catch(u){IBMa.Error.log(u),t({result:"EXCEPTION",details:u})}},stripFirebug:function(e){IBMa.Config.DEBUG&&console.log("stripFirebug");for(var t=e.getElementsByTagName("style"),n=0;n<t.length;n++){var o=t[n];o.wrappedJSObject&&1==o.wrappedJSObject.firebugIgnore&&o.parentNode.removeChild(o)}for(var r=new IBMa.Dom.NodeWalker(e,(!0));null!=r.node&&"body"!=r.node.nodeName.toLowerCase()&&r.prevNode(););if(null!=r.node&&r.node.firstChild&&r.prevNode())for(;r.node!=e&&r.node.firebugIgnore;){var a=r.node;r.bEndTag=!1,r.prevNode(),a.parentNode.removeChild(a)}var i=e.getElementById("_firebugConsole");i&&i.parentNode.removeChild(i)},isNodeVisible:function(e){return null!=RPT.util.isNodeVisible&&void 0!=RPT.util.isNodeVisible&&"undefined"!=RPT.util.isNodeVisible?RPT.util.isNodeVisible(e):IBMa.Scan.isNodeVisibleOld(e)},isNodeVisibleOld:function(e){if(3==e.nodeType&&(e=e.parentNode),!e.ownerDocument)return!0;if(1!=e.nodeType)return!0;var t,n=e.nodeName.toLowerCase();if("script"==n)return!0;if("area"!=n&&"param"!=n&&"audio"!=n){if(e.ownerDocument.defaultView)t=e.ownerDocument.defaultView.getComputedStyle(e,null);else{if(!e.ownerDocument.browserWindow)return!0;t=e.ownerDocument.browserWindow.getComputedStyle(e,null)}if(!t)return!0;if("none"==t.getPropertyValue("display")||"hidden"==t.getPropertyValue("visibility"))return!1}for(var o=e.parentNode;null!=o&&1==o.nodeType;){if(o.ownerDocument&&o.ownerDocument.defaultView?t=o.ownerDocument.defaultView.getComputedStyle(o,null):o.ownerDocument&&o.ownerDocument.browserWindow&&(t=o.ownerDocument.browserWindow.getComputedStyle(o,null)),!t)return!0;if("none"==t.getPropertyValue("display"))return!1;o=o.parentNode}return!0},cleanIter:function(e,t,n,o){IBMa.Config.DEBUG&&console.log("cleanIter");try{for(var r=100,a=["RPT_UTIL_LABELS","RPT_DOCELEMSBYTAG"],i=0;i<a.length;++i)delete e.node.ownerDocument[a[i]];do if(!e.bEndTag){var l=["Rpt_Aria_OrphanedContent","Rpt_Aria_OrphanedContent_NoTrigger","IBM_hasLandmarks","Valerie_Table_DataCellRelationships","Valerie_Table_DataCellRelationships_TrigOnce","rpt_input_buttonsubmittrigger","EXT_Color_Contrast_WCAG2AA","EXT_Link_Contrast_WCAG2AA","PT_NODE_HIDDEN","RPT_UTIL_LABELS","RPT_DOCELEMSBYTAG","Visibility_Check_Parent","PT_NODE_DISABLED","FB_DATA"];do for(var i=0;i<l.length;++i)delete e.node[l[i]];while(e.nextNode())}while(e.nextNode()&&--r>0);0==r?IBMa.Config.setTimeout(function(){IBMa.Scan.cleanIter(e,t,n,o)},0):IBMa.Config.setTimeout(function(){IBMa.Scan.checkIter(t,n,o,null)},0)}catch(u){IBMa.Error.log(u),n({result:"EXCEPTION",details:u})}},evalRule:function(e,t){for(var n=0;n<10;++n)try{var o=t.ownerDocument;IBMa.Config.ruleDocument.setDoc&&IBMa.Config.ruleDocument.setDoc(o);var r=e.validate(t);return r}catch(a){if(9==n)return(IBMa.Config.DEBUG||IBMa.Config.DEBUG_RULES)&&IBMa.Error.log(e.id,a,a.stack),null}},checkIter:function(e,t,n,o){function r(e){if(e&&e.parentNode){var t=e.parentNode,n=e.nodeName.toLowerCase();if(9===t.nodeType)e.FB_DATA={XPATH:"/"+n+"[1]",CN:{}};else{r(t);for(var o=0,a=e.previousSibling;a;)a.nodeName.toLowerCase()===n&&++o,a=a.previousSibling;var i=t.FB_DATA;i.CN[n]=o,e.FB_DATA={XPATH:i.XPATH+"/"+n+"["+(o+1)+"]",CN:{}},i.CN[n]=i.CN[n]+1}}}n&&(e.numNodes=e.numNodes||e.node.ownerDocument.getElementsByTagName("*").length,e.idxNodes=e.idxNodes||1);var a=(new Date).getTime();o||(o={pass:[],numChecked:0,numTrigger:0,ruleTime:0,totalTime:0},1===IBMa.Config.resultsVersion?o.fail=[]:o.issues=[]),IBMa.Config.DEBUG&&console.log("checkIter");try{var i=IBMa.Config.ITER_COUNT;do if(n&&!e.bEndTag&&8!=e.node.nodeType&&3!=e.node.nodeType&&(e.idxNodes=e.idxNodes+1),e.node.getAttribute&&"CCE"===e.node.getAttribute("IBMa"))e.bEndTag=!0;else if(!e.bEndTag&&8!=e.node.nodeType){var l=e.node.nodeName.toLowerCase();if(e.node.parentNode&&e.node.parentNode.FB_DATA){var u=e.node.parentNode.FB_DATA;l in u.CN?e.node.FB_DATA={XPATH:u.XPATH+"/"+l+"["+(u.CN[l]+1)+"]",CN:{}}:(u.CN[l]=0,e.node.FB_DATA={XPATH:u.XPATH+"/"+l+"["+(u.CN[l]+1)+"]",CN:{}}),u.CN[l]=u.CN[l]+1}else r(e.node);var s=!1,d=IBMa.Scan.isNodeVisible(e.node);if(0==IBMa.Config.includeVisibility&&!d&&(s=!0,null==RPT.util.rulesThatHaveToCheckHidden&&void 0==RPT.util.rulesThatHaveToCheckHidden))continue;var f;if(s){if(f=IBMa.Config.getMatchingRulesHidden(e.node,!0),null===f||"undefined"==typeof f||0===f.length)continue}else f=IBMa.Config.getMatchingRules(e.node);for(var g,c={},I=0;I<f.length;++I)if(f[I].enabled&&!(f[I].id in c))try{var B=!0;if(f[I].dependencies)for(var M=0;M<f[I].dependencies.length;++M)if(!c[f[I].dependencies[M]]){B=!1;break}if(!B)continue;var p=(new Date).getTime(),h=IBMa.Scan.evalRule(f[I],e.node);++o.numChecked;var C=(new Date).getTime();if(o.ruleTime+=C-p,C-p>1e3&&console.log("Slow rule (>1s): "+f[I].id),h&&(c[f[I].id]=h.result,IBMa.Config.includePassed||h.result===!1)){var m={msgArgs:h.msgArgs?h.msgArgs:[],ruleId:f[I].id};if(1===IBMa.Config.resultsVersion?(m.component=e.node.FB_DATA.XPATH,m.displayId=f[I].id,m.visible=d,IBMa.Config.includeNodes&&(m.componentNode=e.node)):(m.xpath=e.node.FB_DATA.XPATH,m.snippet=IBMa.Scan.convertNodeToSnippet(e.node)),!g&&IBMa.Config.includeBounds&&e.node.getBoundingClientRect){var v=1;e.node.ownerDocument&&e.node.ownerDocument.defaultView&&e.node.ownerDocument.defaultView.devicePixelRatio&&(v=e.node.ownerDocument.defaultView.devicePixelRatio);var b=e.node.getBoundingClientRect();b?m.bounds=g={left:Math.ceil(b.left*v),top:Math.ceil(b.top*v),height:Math.ceil(b.height*v),width:Math.ceil(b.width*v)}:m.bounds=g={left:0,top:0,height:0,width:0}}else IBMa.Config.includeBounds&&(m.bounds=g);if(e.node.hasAttribute("IBMacustom"))try{m.IBMacustom=JSON.parse(e.node.getAttribute("IBMacustom"))}catch(A){IBMa.Error.log(A)}h.result===!0&&o.pass.push(m),h.result===!1&&(++o.numTrigger,1===IBMa.Config.resultsVersion?o.fail.push(m):o.issues.push(m))}}catch(A){return IBMa.Error.log(A,e.node.nodeName),void t({result:"EXCEPTION",details:A})}}while(e.nextNode()&&--i>0);var T=(new Date).getTime();o.totalTime+=T-a,0==i?(n&&IBMa.Scan.reportProgress(n,e.idxNodes,e.numNodes),IBMa.Config.setTimeout(function(){IBMa.Scan.checkIter(e,t,n,o)},0)):(n&&IBMa.Scan.reportProgress(n),IBMa.Config.DEBUG&&console.log("checkIter complete. Checked",o.numChecked,"in",o.timeChecked,o.debugTime),IBMa.Config.includePassed||delete o.pass,IBMa.Config.setTimeout(function(){t({report:o})},0))}catch(A){return IBMa.Error.log(A),void t({result:"EXCEPTION",details:A})}},convertNodeToSnippet:function(e){var t="";t+="<"+e.nodeName.toLowerCase();var n=e.attributes;if(null!==n&&"undefined"!=typeof n)for(var o=n.length-1;o>=0;o--)t+=" "+n[o].name+'="'+n[o].value+'"';return t+=">"},reportProgress:function(e,t,n){var o=0;o=t&&n&&0!=t?Math.floor(t/n*100):100,e({percentage:o})}}}();var fs=require("fs"),request=require("request");IBMa.Config.setTimeout=function(e,t){process.nextTick(e)},IBMa.GSALoader={loading:1,initStarted:!1,initCBs:[],ROOTURL:"https://pages.github.ibm.com/IBMa/IBM-RulePages/js/latest/",useCache:!1,init:function(e){"string"==typeof IBMa.GSALoader.ROOTURL&&(IBMa.GSALoader.ROOTURL=[{cache:"default",url:IBMa.GSALoader.ROOTURL}]),IBMa.GSALoader.initStarted?IBMa.Config.loaded?e&&e():e&&IBMa.GSALoader.initCBs.push(e):(IBMa.GSALoader.initStarted=!0,e&&IBMa.GSALoader.initCBs.push(e),IBMa.GSALoader.loading=4*IBMa.GSALoader.ROOTURL.length,IBMa.Config.DEBUG&&console.log("INITIAL load count="+IBMa.GSALoader.loading),IBMa.GSALoader.loadJSON("nls.json",function(e){IBMa.Config.addNLS("en-us",e),--IBMa.GSALoader.loading,0==IBMa.GSALoader.loading&&IBMa.GSALoader.onLoaded()}),IBMa.GSALoader.loadJSON("rulesets.json",function(e){for(var t=0;t<e.length;++t)IBMa.Config.addRuleset(e[t]);--IBMa.GSALoader.loading,0==IBMa.GSALoader.loading&&IBMa.GSALoader.onLoaded()}),IBMa.GSALoader.loadJSON("metadata.json",function(e){IBMa.Config.addMetadata(e),--IBMa.GSALoader.loading,0==IBMa.GSALoader.loading&&IBMa.GSALoader.onLoaded()}),IBMa.GSALoader.loadRules("rules.js",function(e){IBMa.Config.addRules(e),--IBMa.GSALoader.loading,0==IBMa.GSALoader.loading&&IBMa.GSALoader.onLoaded()}))},fireConfigLoaded:function(e){e&&IBMa.GSALoader.initCBs.push(e),IBMa.GSALoader.initStarted=!0,IBMa.GSALoader.loading=0,IBMa.GSALoader.onLoaded()},onLoaded:function(){for(IBMa.Config.DEBUG&&console.log("onLoaded"),IBMa.Config.loaded=!0;IBMa.GSALoader.initCBs.length>0;)IBMa.GSALoader.initCBs.pop()()},loadRules:function(e,t){for(var n=0;n<IBMa.GSALoader.ROOTURL.length;++n){var o=__dirname+"/cache/"+IBMa.GSALoader.ROOTURL[n].cache+"-"+e;if(IBMa.GSALoader.useCache&&fs.existsSync(o))IBMa.Config.ruleDocument=require(o),t(IBMa.Config.ruleDocument.rules);else{++IBMa.GSALoader.loading;var r=IBMa.GSALoader.ROOTURL[n].url+e,a={};IBMa.Config.pem&&(a.agentOptions={ca:IBMa.Config.pem}),request(r,a,function(n,a,i){n||200!=a.statusCode?console.log("Got an error: ",n,", file: ",e," fileUrl: ",r):(i='var document = null;var window = null;module.exports = { "rules" : []};module.exports.setDoc = function(doc) {document = doc;window=doc.defaultView;};var OpenAjax = { "a11y" : { "ruleMap" : {},"addRules" : function(rules) {for (var i=0; i<rules.length; ++i) { module.exports.rules.push(rules[i]); OpenAjax.a11y.ruleMap[rules[i].id]=rules[i];}},"getRule" : function(ruleId) {return OpenAjax.a11y.ruleMap[ruleId];}}};var ValidationResult = function(result, nodes, attrs, text, msgArgs) {this.result = typeof result == "boolean" ? result : Boolean(result);this.nodes = nodes;this.attrs = attrs;this.textContent = text;this.msgArgs = msgArgs;return true;};var XPathResult =  { "ANY_TYPE": 0, "NUMBER_TYPE": 1, "STRING_TYPE": 2, "BOOLEAN_TYPE": 3,"UNORDERED_NODE_ITERATOR_TYPE": 4, "ORDERED_NODE_ITERATOR_TYPE": 5, "UNORDERED_NODE_SNAPSHOT_TYPE": 6,"ORDERED_NODE_SNAPSHOT_TYPE": 7, "ANY_UNORDERED_NODE_TYPE": 8, "FIRST_ORDERED_NODE_TYPE": 9 };'+i,fs.writeFileSync(o,i),IBMa.Config.ruleDocument=require(o),t(IBMa.Config.ruleDocument.rules),--IBMa.GSALoader.loading,0==IBMa.GSALoader.loading&&IBMa.GSALoader.onLoaded())})}}},loadJSON:function(e,t){for(var n=0;n<IBMa.GSALoader.ROOTURL.length;++n){var o=__dirname+"/cache/"+IBMa.GSALoader.ROOTURL[n].cache+"-"+e;if(IBMa.GSALoader.useCache&&fs.existsSync(o))t(require(o));else{++IBMa.GSALoader.loading;var r=IBMa.GSALoader.ROOTURL[n].url+e,a={};IBMa.Config.pem&&(a.agentOptions={ca:IBMa.Config.pem}),request(r,a,function(n,a,i){n||200!=a.statusCode?console.log("Got an error: ",n,", file: ",e," fileUrl: ",r):(fs.writeFileSync(o,i),t(require(o)),--IBMa.GSALoader.loading,0==IBMa.GSALoader.loading&&IBMa.GSALoader.onLoaded())})}}},addServers:function(e){IBMa.GSALoader._serverInfo=e}},IBMa.validate=function(e,t,n,o){IBMa.GSALoader.init(function(){IBMa.Config.DEBUG&&console.log("validate::init complete");try{1==e.nodeType&&(e=e.ownerDocument),IBMa.Scan.reportDocument(e,t,n,o)}catch(r){n({exceptionD:""+r})}})};var ValidationResult=function(e,t,n,o,r){return this.result="boolean"==typeof e?e:Boolean(e),this.nodes=t,this.attrs=n,this.textContent=o,this.msgArgs=r,!0},getRule=function(e){return IBMa.Config.rulesById[e]};module.exports=IBMa;