module.exports = function (bluemixConfig, params) {
    if (typeof (bluemixConfig) === typeof ("")) {
        bluemixConfig = require(bluemixConfig);
    }

    var aatLog;
    if (bluemixConfig) {
        aatLog = require("./AATLog")({
            "instanceId": bluemixConfig.instanceId,
            "projectId": bluemixConfig.projectId,
            "instanceUser": bluemixConfig.instanceUser,
            "instancePass": bluemixConfig.instancePass,
            "endpoint": bluemixConfig.endpoint,
            "pem": params.pem,
            "persist": params.persist
        });
    }
    if (typeof(params) === "undefined") {
        params = {};
    }

    if (typeof (params.includeHidden) === "undefined")
        params.includeHidden = false;
    if (typeof (params.takeScreenshot) === "undefined")
        params.takeScreenshot = true;
    if (!params.policies) {
        params.policies = null;
    }
    params.filterMap = null;
    if (params.filterLevels) {
        params.filterMap = {};
        params.filterLevels.forEach(function (filter) {
            params.filterMap[filter] = true;
        });
    }

    return {
        "Selenium": function (driver) {
            return require("./Selenium")(aatLog, bluemixConfig, driver, params);
        },
        "Zombie": function (driver) {
            return require("./Zombie")(aatLog, bluemixConfig, driver, params);
        },
        "Scan": function () {
            return require("./Scan")(aatLog, bluemixConfig, params);
        }
    }
}