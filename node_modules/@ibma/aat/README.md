#Automated Accessibility Tester

See [Terms](https://www-03.ibm.com/software/sla/sladb.nsf/sla/bm-6620-01?Open&cm_mc_uid=15176199089014551186427&cm_mc_sid_50200000=1463172947).

The Automated Accessibility Tester currently provides wrappers for: 
* Selenium
* Zombie
* DOM

The scanner will support integration with the IBM [Automated Accessibility Tester](https://ibm.biz/bluemix-aat) for Bluemix.
This integration currently only works through the US stage1 server.

If using Selenium without Bluemix, the Selenium server must have visibility to
https://pages.github.ibm.com/IBMa/IBM-RulePages/*

## For each of these tools, the result follows a format similar to:
```
{ 
    "counts": {
        "level.violation": 0,
        "level.potentialviolation": 0,
        "level.recommendation": 0,
        "level.potentialrecommendation": 0,
        "level.manual": 0
    },
    "reports" : [
        {
            "frameIdx" : 0,
            "report" : [
                { 
                    "severity": 'High',
                    "severityCode": 'eISHigh',
                    "message": 'All content must reside within a WAI-ARIA landmark or labelled region role.',
                    "messageCode": 'wcag20.tech.aria.OrphanedContent',
                    "ruleId": '1088',
                    "help": 'idhi_accessibility_check_g1088.html',
                    "component": '/html[1]/body[1]/div[1]/div[5]/div[1]/a[1]',
                    "displayId": 'Rpt_Aria_OrphanedContent',
                    "msgArgs": [],
                    "visible": true,
                    "bounds": { left: 0, top: 0, height: 0, width: 0 },
                    "rsInfo": 
                    [ 
                        {
                            rs: {
                                id: 'CI162_5_2_DCP080115',
                                label: 'IBM CI162 Web Checklist (v5.2) Plan DCP, 01 August 2015 or later' 
                            },
                            requirement: {
                                id: '2.4a',
                                label: 'Navigational Features: A mechanism is available to bypass blocks of content that are repeated on multiple Web pages.',
                                level: 'A' 
                            },
                            levelCode: 'level.potentialviolation' 
                        }                        
                    ],
                    "level": 'level.violation' 
                }
            ]
        }
    ]
}
```
  
## Scanning using DOM

```
var options = {
    "policies" : "CI162_5_2_DCP080115
};
var aat = require("@ibma/aat")(null, options);
var scanner = aat.Scan();
scanner.getCompliance(doc).then(function(result) {
    // See format above
});
```

In this scenario, doc may be any DOM document obtained in a variety of ways (e.g., jsdom, zombie, etc). 

## Scanning using Zombie

```
var zombie = require("zombie");
var options = {
    "policies" : "CI162_5_2_DCP080115
};
var aat = require("@ibma/aat")(null, options);
var driver = aat.Zombie(new zombie());

driver.visit('http://www.google.com', function() {
    driver.getCompliance().then(function(return_value) {
        // See format above
    });
});
```

## Scanning using Selenium
Note below that the id being used is IBM\_ as opposed to CI162\_. The IBM\_ ruleset includes two color contrast checking rules that were deployed for Bluemix. Will pull in the more standard internal rulesets soon.
```
var configPath = __dirname+"/dashboard-config.json";

var options = {
    // optional - Policies to scan. Default is all policies.
    "policies" : ["IBM_DCP080115"],
    // optional - flag to include hidden content, default false
    "includeHidden" : false, 
    // optional - if level is in the map with any value, it will be included.
    // Default includes all levels
    "filterMap" : {  
        "level.violation" : true,
        "level.potentialviolation" : true,
        "level.recommendation" : true,
        "level.potentialrecommendation" : true,
        "level.manual" : true
    }
}

var bmConfig = JSON.parse(fs.readFileSync(configPath));
var aat = require("@ibma/aat")(null, options);
var driver = aat.Selenium(seleniumDriver);

driver.get('http://www.google.com/ncr');
driver.getCompliance().then(function(return_value) {
    // See format above
}
```